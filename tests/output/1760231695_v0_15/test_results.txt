Loading CVE JSON files...
1680it [00:00, 2097.23it/s]
Loaded 1680 CVEs
Generating embeddings...
Model loaded from: ./domain_adapted_model
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 53/53 [00:01<00:00, 45.57it/s]
Embeddings shape: (1680, 384), sample: [ 0.09512987  0.10447408  0.10577734  0.03425939 -0.02108146]...
Building ArrowSpace...
[pyarrowspace] Convert pyarray2 and Vec<Vec>
[pyarrowspace] items shape: (1680, 384)
[pyarrowspace] items[0][:5]: [0.9512986987829208, 1.0447408258914948, 1.057773381471634, 0.3425939008593559, -0.21081464365124702]
[pyarrowspace] NaNs: 0, Infs: 0
[pyarrowspace] Building from rows
[pyarrowspace] built ArrowSpace: nitems=1680, nfeatures=384, lambdas_len=1680
Build time: 117.65s

Searching 3 queries...
Model loaded from: ./domain_adapted_model
Batches: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 187.73it/s]
Embeddings shape: (3, 384), sample: [-0.0122127   0.05706869 -0.01711867 -0.07662857 -0.11884194]...

======================================================================
Query 1: authenticated arbitrary file read path traversal
======================================================================
[pyarrowspace] search: qlen=384, lambda_q=0.096112
[pyarrowspace] search: qlen=384, lambda_q=0.096112
[pyarrowspace] search: qlen=384, lambda_q=0.096112
Results: cosine=10, hybrid=10, taumode=10, using min=10

Cosine (τ=1.0)
----------------------------------------------------------------------
 1. CVE-1999-1509      (no title)                               [0.6307]
 2. CVE-1999-0468      (no title)                               [0.6013]
 3. CVE-1999-0891      (no title)                               [0.5966]
 4. CVE-1999-1541      (no title)                               [0.5884]
 5. CVE-1999-1082      (no title)                               [0.5834]
 6. CVE-1999-1437      (no title)                               [0.5756]
 7. CVE-1999-1375      (no title)                               [0.5689]
 8. CVE-1999-0870      (no title)                               [0.5652]
 9. CVE-1999-0927      (no title)                               [0.5637]
10. CVE-1999-0882      (no title)                               [0.5560]

Hybrid (τ=0.8)
----------------------------------------------------------------------
 1. CVE-1999-1509      (no title)                               [0.6876]
 2. CVE-1999-0468      (no title)                               [0.6666]
 3. CVE-1999-0891      (no title)                               [0.6623]
 4. CVE-1999-1541      (no title)                               [0.6540]
 5. CVE-1999-1082      (no title)                               [0.6498]
 6. CVE-1999-1437      (no title)                               [0.6439]
 7. CVE-1999-0870      (no title)                               [0.6405]
 8. CVE-1999-1375      (no title)                               [0.6398]
 9. CVE-1999-0927      (no title)                               [0.6376]
10. CVE-1999-1081      (no title)                               [0.6332]

Taumode (τ=0.62)
----------------------------------------------------------------------
 1. CVE-1999-1509      (no title)                               [0.7388]
 2. CVE-1999-0468      (no title)                               [0.7254]
 3. CVE-1999-0891      (no title)                               [0.7214]
 4. CVE-1999-1541      (no title)                               [0.7130]
 5. CVE-1999-1082      (no title)                               [0.7094]
 6. CVE-1999-0870      (no title)                               [0.7082]
 7. CVE-1999-1437      (no title)                               [0.7053]
 8. CVE-1999-0927      (no title)                               [0.7040]
 9. CVE-1999-1081      (no title)                               [0.7040]
10. CVE-1999-1375      (no title)                               [0.7036]

Correlations:
  Cosine vs Hybrid:   ρ=0.983, τ=0.944
  Cosine vs Taumode:  ρ=0.917, τ=0.833
  Hybrid vs Taumode:  ρ=0.952, τ=0.867

NDCG@10:
  Hybrid vs Cosine:   0.9994
  Taumode vs Cosine:  0.9953
  Taumode vs Hybrid:  0.9980

Tail Quality (Ranks 4-10):
  Cosine (τ=1.0):
    T/H ratio: 0.9378
    CV: 0.0186
  Hybrid (τ=0.8):
    T/H ratio: 0.9561
    CV: 0.0103
  Taumode (τ=0.62):
    T/H ratio: 0.9701
    CV: 0.0047

======================================================================
Query 2: remote code execution in ERP web component
======================================================================
[pyarrowspace] search: qlen=384, lambda_q=0.017374
[pyarrowspace] search: qlen=384, lambda_q=0.017374
[pyarrowspace] search: qlen=384, lambda_q=0.017374
Results: cosine=10, hybrid=10, taumode=10, using min=10

Cosine (τ=1.0)
----------------------------------------------------------------------
 1. CVE-1999-0738      (no title)                               [0.5933]
 2. CVE-1999-1081      (no title)                               [0.5834]
 3. CVE-1999-0177      (no title)                               [0.5729]
 4. CVE-1999-0440      (no title)                               [0.5717]
 5. CVE-1999-0237      (no title)                               [0.5677]
 6. CVE-1999-0933      (no title)                               [0.5573]
 7. CVE-1999-1083      (no title)                               [0.5548]
 8. CVE-1999-0264      (no title)                               [0.5498]
 9. CVE-1999-0739      (no title)                               [0.5421]
10. CVE-1999-1082      (no title)                               [0.5358]

Hybrid (τ=0.8)
----------------------------------------------------------------------
 1. CVE-1999-0738      (no title)                               [0.6645]
 2. CVE-1999-1081      (no title)                               [0.6614]
 3. CVE-1999-0177      (no title)                               [0.6526]
 4. CVE-1999-0237      (no title)                               [0.6507]
 5. CVE-1999-0440      (no title)                               [0.6490]
 6. CVE-1999-0933      (no title)                               [0.6448]
 7. CVE-1999-1083      (no title)                               [0.6400]
 8. CVE-1999-0264      (no title)                               [0.6393]
 9. CVE-1999-1082      (no title)                               [0.6274]
10. CVE-1999-0739      (no title)                               [0.6272]

Taumode (τ=0.62)
----------------------------------------------------------------------
 1. CVE-1999-1081      (no title)                               [0.7315]
 2. CVE-1999-0738      (no title)                               [0.7285]
 3. CVE-1999-0237      (no title)                               [0.7255]
 4. CVE-1999-0177      (no title)                               [0.7244]
 5. CVE-1999-0933      (no title)                               [0.7235]
 6. CVE-1999-0264      (no title)                               [0.7198]
 7. CVE-1999-0440      (no title)                               [0.7186]
 8. CVE-1999-1083      (no title)                               [0.7167]
 9. CVE-1999-1082      (no title)                               [0.7098]
10. CVE-2018-19998     (no title)                               [0.7058]

Correlations:
  Cosine vs Hybrid:   ρ=0.976, τ=0.911
  Cosine vs Taumode:  ρ=0.817, τ=0.667
  Hybrid vs Taumode:  ρ=0.883, τ=0.722

NDCG@10:
  Hybrid vs Cosine:   0.9981
  Taumode vs Cosine:  0.9754
  Taumode vs Hybrid:  0.9813

Tail Quality (Ranks 4-10):
  Cosine (τ=1.0):
    T/H ratio: 0.9502
    CV: 0.0216
  Hybrid (τ=0.8):
    T/H ratio: 0.9701
    CV: 0.0138
  Taumode (τ=0.62):
    T/H ratio: 0.9841
    CV: 0.0089

======================================================================
Query 3: SQL injection in login endpoint
======================================================================
[pyarrowspace] search: qlen=384, lambda_q=0.014667
[pyarrowspace] search: qlen=384, lambda_q=0.014667
[pyarrowspace] search: qlen=384, lambda_q=0.014667
Results: cosine=10, hybrid=10, taumode=10, using min=10

Cosine (τ=1.0)
----------------------------------------------------------------------
 1. CVE-2018-19998     (no title)                               [0.5860]
 2. CVE-2018-1999028   (no title)                               [0.5162]
 3. CVE-2018-1999039   (no title)                               [0.5028]
 4. CVE-1999-0360      (no title)                               [0.4664]
 5. CVE-1999-1188      (no title)                               [0.4574]
 6. CVE-2018-1999036   (no title)                               [0.4533]
 7. CVE-2018-1999040   (no title)                               [0.4503]
 8. CVE-1999-1260      (no title)                               [0.4500]
 9. CVE-1999-1556      (no title)                               [0.4491]
10. CVE-2018-19995     (no title)                               [0.4428]

Hybrid (τ=0.8)
----------------------------------------------------------------------
 1. CVE-2018-19998     (no title)                               [0.6679]
 2. CVE-2018-1999028   (no title)                               [0.6123]
 3. CVE-2018-1999039   (no title)                               [0.6018]
 4. CVE-1999-0360      (no title)                               [0.5701]
 5. CVE-2018-1999036   (no title)                               [0.5618]
 6. CVE-1999-1188      (no title)                               [0.5610]
 7. CVE-2018-1999040   (no title)                               [0.5596]
 8. CVE-1999-1260      (no title)                               [0.5564]
 9. CVE-1999-1556      (no title)                               [0.5549]
10. CVE-2018-19995     (no title)                               [0.5532]

Taumode (τ=0.62)
----------------------------------------------------------------------
 1. CVE-2018-19998     (no title)                               [0.7416]
 2. CVE-2018-1999028   (no title)                               [0.6987]
 3. CVE-2018-1999039   (no title)                               [0.6908]
 4. CVE-1999-0360      (no title)                               [0.6634]
 5. CVE-2018-1999036   (no title)                               [0.6595]
 6. CVE-2018-1999040   (no title)                               [0.6579]
 7. CVE-1999-1188      (no title)                               [0.6543]
 8. CVE-2018-19995     (no title)                               [0.6525]
 9. CVE-2018-1999031   (no title)                               [0.6524]
10. CVE-1999-1260      (no title)                               [0.6522]

Correlations:
  Cosine vs Hybrid:   ρ=0.988, τ=0.956
  Cosine vs Taumode:  ρ=0.933, τ=0.833
  Hybrid vs Taumode:  ρ=0.967, τ=0.889

NDCG@10:
  Hybrid vs Cosine:   0.9990
  Taumode vs Cosine:  0.9952
  Taumode vs Hybrid:  0.9970

Tail Quality (Ranks 4-10):
  Cosine (τ=1.0):
    T/H ratio: 0.8463
    CV: 0.0153
  Hybrid (τ=0.8):
    T/H ratio: 0.8921
    CV: 0.0093
  Taumode (τ=0.62):
    T/H ratio: 0.9235
    CV: 0.0061
Top-10 plot saved to cve_top10_comparison.png
/datadisk/publish/pyarrowspace/tests/test_2_CVE_db.py:296: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  bp = ax3.boxplot(tail_data, labels=['Cosine', 'Hybrid', 'Taumode'],
/datadisk/publish/pyarrowspace/tests/test_2_CVE_db.py:296: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  bp = ax3.boxplot(tail_data, labels=['Cosine', 'Hybrid', 'Taumode'],
/datadisk/publish/pyarrowspace/tests/test_2_CVE_db.py:296: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  bp = ax3.boxplot(tail_data, labels=['Cosine', 'Hybrid', 'Taumode'],
Tail analysis plot saved to cve_tail_analysis.png

======================================================================
SUMMARY
======================================================================

Average NDCG@10:
  Hybrid vs Cosine:   0.9988
  Taumode vs Cosine:  0.9886

Average Tail/Head Ratios:
  Cosine (τ=1.0): 0.9114 ± 0.0463
  Hybrid (τ=0.8): 0.9394 ± 0.0340
  Taumode (τ=0.62): 0.9593 ± 0.0259

→ Higher T/H ratio = Better long-tail quality
→ ArrowSpace (τ<1.0) maintains higher tail scores