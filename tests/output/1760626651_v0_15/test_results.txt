Loading CVE JSON files...
313841it [01:43, 3020.51it/s]
Loaded 313841 CVEs
Generating embeddings...
/datadisk/publish/pyarrowspace/.venv/lib/python3.12/site-packages/torch/cuda/__init__.py:182: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 804: forward compatibility was attempted on non supported HW (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
Model loaded from: ./domain_adapted_model
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9808/9808 [1:07:26<00:00,  2.42it/s]
Embeddings shape: (313841, 384), sample: [-0.05824164  0.14389713  0.05094871  0.04408194 -0.01066009]...
Building ArrowSpace...
[pyarrowspace] Convert pyarray2 and Vec<Vec>
[pyarrowspace] items shape: (313841, 384)
[pyarrowspace] items[0][:5]: [-0.5824163928627968, 1.4389713108539581, 0.5094871297478676, 0.4408194497227669, -0.10660090483725071]
[pyarrowspace] NaNs: 0, Infs: 0
[pyarrowspace] Building from rows
sparsity 0.9939759036144579
[pyarrowspace] built ArrowSpace: nitems=313841, nfeatures=384, lambdas_len=313841
Build time: 1690.40s

Searching 3 queries...
Model loaded from: ./domain_adapted_model
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  9.52it/s]
Embeddings shape: (3, 384), sample: [-0.01221271  0.05706873 -0.0171186  -0.07662845 -0.11884186]...

======================================================================
Query 1: authenticated arbitrary file read path traversal
======================================================================
[pyarrowspace] search: qlen=384, lambda_q=0.014810
[pyarrowspace] search: qlen=384, lambda_q=0.014810
[pyarrowspace] search: qlen=384, lambda_q=0.014810
Results: cosine=10, hybrid=10, taumode=10, using min=10

Cosine (τ=1.0)
----------------------------------------------------------------------
 1. CVE-2004-2290      (no title)                               [0.7329]
 2. CVE-2002-1345      (no title)                               [0.7120]
 3. CVE-2009-4053      (no title)                               [0.7115]
 4. CVE-2009-4957      (no title)                               [0.7112]
 5. CVE-2002-0347      (no title)                               [0.7082]
 6. CVE-2024-22050     Iodine Static File Server Path Traversal Vulnerability [0.7005]
 7. CVE-2009-1314      (no title)                               [0.6968]
 8. CVE-2007-4842      (no title)                               [0.6966]
 9. CVE-2008-6785      (no title)                               [0.6936]
10. CVE-2008-4319      (no title)                               [0.6896]

Hybrid (τ=0.8)
----------------------------------------------------------------------
 1. CVE-2004-2290      (no title)                               [0.7834]
 2. CVE-2002-1345      (no title)                               [0.7667]
 3. CVE-2009-4053      (no title)                               [0.7663]
 4. CVE-2009-4957      (no title)                               [0.7660]
 5. CVE-2002-0347      (no title)                               [0.7636]
 6. CVE-2024-22050     Iodine Static File Server Path Traversal Vulnerability [0.7575]
 7. CVE-2009-1314      (no title)                               [0.7545]
 8. CVE-2007-4842      (no title)                               [0.7543]
 9. CVE-2008-6785      (no title)                               [0.7519]
10. CVE-2008-4319      (no title)                               [0.7487]

Taumode (τ=0.62)
----------------------------------------------------------------------
 1. CVE-2004-2290      (no title)                               [0.8288]
 2. CVE-2002-1345      (no title)                               [0.8158]
 3. CVE-2009-4053      (no title)                               [0.8155]
 4. CVE-2009-4957      (no title)                               [0.8153]
 5. CVE-2002-0347      (no title)                               [0.8135]
 6. CVE-2024-22050     Iodine Static File Server Path Traversal Vulnerability [0.8087]
 7. CVE-2009-1314      (no title)                               [0.8064]
 8. CVE-2007-4842      (no title)                               [0.8062]
 9. CVE-2008-6785      (no title)                               [0.8044]
10. CVE-2008-4319      (no title)                               [0.8019]

Correlations:
  Cosine vs Hybrid:   ρ=1.000, τ=1.000
  Cosine vs Taumode:  ρ=1.000, τ=1.000
  Hybrid vs Taumode:  ρ=1.000, τ=1.000

NDCG@10:
  Hybrid vs Cosine:   1.0000
  Taumode vs Cosine:  1.0000
  Taumode vs Hybrid:  1.0000

Tail Quality (Ranks 4-10):
  Cosine (τ=1.0):
    T/H ratio: 0.9731
    CV: 0.0103
  Hybrid (τ=0.8):
    T/H ratio: 0.9800
    CV: 0.0076
  Taumode (τ=0.62):
    T/H ratio: 0.9854
    CV: 0.0055

======================================================================
Query 2: remote code execution in ERP web component
======================================================================
[pyarrowspace] search: qlen=384, lambda_q=0.017517
[pyarrowspace] search: qlen=384, lambda_q=0.017517
[pyarrowspace] search: qlen=384, lambda_q=0.017517
Results: cosine=10, hybrid=10, taumode=10, using min=10

Cosine (τ=1.0)
----------------------------------------------------------------------
 1. CVE-2012-0980      (no title)                               [0.6630]
 2. CVE-2008-6260      (no title)                               [0.6590]
 3. CVE-2008-5223      (no title)                               [0.6548]
 4. CVE-2002-0233      (no title)                               [0.6481]
 5. CVE-2008-2792      (no title)                               [0.6392]
 6. CVE-2006-0821      (no title)                               [0.6390]
 7. CVE-2008-1407      (no title)                               [0.6379]
 8. CVE-2025-26186     (no title)                               [0.6362]
 9. CVE-2008-5269      (no title)                               [0.6358]
10. CVE-2009-1323      (no title)                               [0.6339]

Hybrid (τ=0.8)
----------------------------------------------------------------------
 1. CVE-2012-0980      (no title)                               [0.7269]
 2. CVE-2008-6260      (no title)                               [0.7237]
 3. CVE-2008-5223      (no title)                               [0.7204]
 4. CVE-2002-0233      (no title)                               [0.7150]
 5. CVE-2008-2792      (no title)                               [0.7079]
 6. CVE-2006-0821      (no title)                               [0.7077]
 7. CVE-2008-1407      (no title)                               [0.7068]
 8. CVE-2025-26186     (no title)                               [0.7055]
 9. CVE-2008-5269      (no title)                               [0.7051]
10. CVE-2009-1323      (no title)                               [0.7036]

Taumode (τ=0.62)
----------------------------------------------------------------------
 1. CVE-2012-0980      (no title)                               [0.7844]
 2. CVE-2008-6260      (no title)                               [0.7820]
 3. CVE-2008-5223      (no title)                               [0.7793]
 4. CVE-2002-0233      (no title)                               [0.7752]
 5. CVE-2008-2792      (no title)                               [0.7697]
 6. CVE-2006-0821      (no title)                               [0.7695]
 7. CVE-2008-1407      (no title)                               [0.7688]
 8. CVE-2025-26186     (no title)                               [0.7678]
 9. CVE-2008-5269      (no title)                               [0.7675]
10. CVE-2009-1323      (no title)                               [0.7663]

Correlations:
  Cosine vs Hybrid:   ρ=1.000, τ=1.000
  Cosine vs Taumode:  ρ=1.000, τ=1.000
  Hybrid vs Taumode:  ρ=1.000, τ=1.000

NDCG@10:
  Hybrid vs Cosine:   1.0000
  Taumode vs Cosine:  1.0000
  Taumode vs Hybrid:  1.0000

Tail Quality (Ranks 4-10):
  Cosine (τ=1.0):
    T/H ratio: 0.9691
    CV: 0.0067
  Hybrid (τ=0.8):
    T/H ratio: 0.9775
    CV: 0.0048
  Taumode (τ=0.62):
    T/H ratio: 0.9838
    CV: 0.0035

======================================================================
Query 3: SQL injection in login endpoint
======================================================================
[pyarrowspace] search: qlen=384, lambda_q=0.015676
[pyarrowspace] search: qlen=384, lambda_q=0.015676
[pyarrowspace] search: qlen=384, lambda_q=0.015676
Results: cosine=10, hybrid=10, taumode=10, using min=10

Cosine (τ=1.0)
----------------------------------------------------------------------
 1. CVE-2007-5916      (no title)                               [0.7630]
 2. CVE-2009-3430      (no title)                               [0.7353]
 3. CVE-2014-1466      (no title)                               [0.7338]
 4. CVE-2008-1631      (no title)                               [0.7311]
 5. CVE-2008-5573      (no title)                               [0.7261]
 6. CVE-2008-6582      (no title)                               [0.7244]
 7. CVE-2008-6941      (no title)                               [0.7220]
 8. CVE-2009-0738      (no title)                               [0.7220]
 9. CVE-2006-0192      (no title)                               [0.7212]
10. CVE-2008-6332      (no title)                               [0.7211]

Hybrid (τ=0.8)
----------------------------------------------------------------------
 1. CVE-2007-5916      (no title)                               [0.8072]
 2. CVE-2009-3430      (no title)                               [0.7851]
 3. CVE-2014-1466      (no title)                               [0.7839]
 4. CVE-2008-1631      (no title)                               [0.7817]
 5. CVE-2008-5573      (no title)                               [0.7777]
 6. CVE-2008-6582      (no title)                               [0.7764]
 7. CVE-2008-6941      (no title)                               [0.7745]
 8. CVE-2009-0738      (no title)                               [0.7744]
 9. CVE-2006-0192      (no title)                               [0.7739]
10. CVE-2008-6332      (no title)                               [0.7738]

Taumode (τ=0.62)
----------------------------------------------------------------------
 1. CVE-2007-5916      (no title)                               [0.8471]
 2. CVE-2009-3430      (no title)                               [0.8299]
 3. CVE-2014-1466      (no title)                               [0.8290]
 4. CVE-2008-1631      (no title)                               [0.8273]
 5. CVE-2008-5573      (no title)                               [0.8242]
 6. CVE-2008-6582      (no title)                               [0.8232]
 7. CVE-2008-6941      (no title)                               [0.8217]
 8. CVE-2009-0738      (no title)                               [0.8217]
 9. CVE-2006-0192      (no title)                               [0.8212]
10. CVE-2008-6332      (no title)                               [0.8211]

Correlations:
  Cosine vs Hybrid:   ρ=1.000, τ=1.000
  Cosine vs Taumode:  ρ=1.000, τ=1.000
  Hybrid vs Taumode:  ρ=1.000, τ=1.000

NDCG@10:
  Hybrid vs Cosine:   1.0000
  Taumode vs Cosine:  1.0000
  Taumode vs Hybrid:  1.0000

Tail Quality (Ranks 4-10):
  Cosine (τ=1.0):
    T/H ratio: 0.9731
    CV: 0.0046
  Hybrid (τ=0.8):
    T/H ratio: 0.9798
    CV: 0.0035
  Taumode (τ=0.62):
    T/H ratio: 0.9851
    CV: 0.0025

======================================================================
EXPORTING RESULTS TO CSV
======================================================================
Search results saved to cve_search_results.csv
Comparison metrics saved to cve_comparison_metrics.csv
Tail metrics saved to cve_tail_metrics.csv
Summary statistics saved to cve_summary.csv

======================================================================
SUMMARY
======================================================================

Average NDCG@10:
  Hybrid vs Cosine:   1.0000
  Taumode vs Cosine:  1.0000

Average Tail/Head Ratios:
  Cosine (τ=1.0): 0.9718 ± 0.0019
  Hybrid (τ=0.8): 0.9791 ± 0.0011
  Taumode (τ=0.62): 0.9848 ± 0.0007

→ Higher T/H ratio = Better long-tail quality
→ ArrowSpace (τ<1.0) maintains higher tail scores